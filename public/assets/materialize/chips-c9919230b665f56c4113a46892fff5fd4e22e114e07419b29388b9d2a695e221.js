!function(e){var t=!1,i={data:[],placeholder:"",secondaryPlaceholder:""};e(document).ready(function(){e(document).on("click",".chip .close",function(){var t=e(this).closest(".chips");t.data("initialized")||e(this).closest(".chip").remove()})}),e.fn.material_chip=function(a){var n=this;return this.$el=e(this),this.$document=e(document),this.SELS={CHIPS:".chips",CHIP:".chip",INPUT:"input",DELETE:".material-icons",SELECTED_CHIP:".selected"},"data"===a?this.$el.data("chips"):"options"===a?this.$el.data("options"):(this.$el.data("options",e.extend({},i,a)),this.init=function(){var t=0;n.$el.each(function(){var i=e(this);if(!i.data("initialized")){var a=i.data("options");(!a.data||!a.data instanceof Array)&&(a.data=[]),i.data("chips",a.data),i.data("index",t),i.data("initialized",!0),i.hasClass(n.SELS.CHIPS)||i.addClass("chips"),n.chips(i),t++}})},this.handleEvents=function(){var t=n.SELS;n.$document.on("click",t.CHIPS,function(i){e(i.target).find(t.INPUT).focus()}),n.$document.on("click",t.CHIP,function(){e(t.CHIP).removeClass("selected"),e(this).toggleClass("selected")}),n.$document.on("keydown",function(i){if(!e(i.target).is("input, textarea")){var a,s=n.$document.find(t.CHIP+t.SELECTED_CHIP),c=s.closest(t.CHIPS),d=s.siblings(t.CHIP).length;if(s.length)if(8===i.which||46===i.which){i.preventDefault();var o=c.data("index");a=s.index(),n.deleteChip(o,a,c);var l=null;a+1<d?l=a:a!==d&&a+1!==d||(l=d-1),l<0&&(l=null),null!==l&&n.selectChip(o,l,c),d||c.find("input").focus()}else if(37===i.which){if(a=s.index()-1,a<0)return;e(t.CHIP).removeClass("selected"),n.selectChip(c.data("index"),a,c)}else if(39===i.which){if(a=s.index()+1,e(t.CHIP).removeClass("selected"),a>d)return void c.find("input").focus();n.selectChip(c.data("index"),a,c)}}}),n.$document.on("focusin",t.CHIPS+" "+t.INPUT,function(i){e(i.target).closest(t.CHIPS).addClass("focus"),e(t.CHIP).removeClass("selected")}),n.$document.on("focusout",t.CHIPS+" "+t.INPUT,function(i){e(i.target).closest(t.CHIPS).removeClass("focus")}),n.$document.on("keydown",t.CHIPS+" "+t.INPUT,function(i){var a=e(i.target),s=a.closest(t.CHIPS),c=s.data("index"),d=s.children(t.CHIP).length;return 13===i.which?(i.preventDefault(),n.addChip(c,{tag:a.val()},s),void a.val("")):8!==i.keyCode&&37!==i.keyCode||""!==a.val()||!d?void 0:(n.selectChip(c,d-1,s),void a.blur())}),n.$document.on("click",t.CHIPS+" "+t.DELETE,function(i){var a=e(i.target),s=a.closest(t.CHIPS),c=a.closest(t.CHIP);i.stopPropagation(),n.deleteChip(s.data("index"),c.index(),s),s.find("input").focus()})},this.chips=function(e){var t="";e.data("options");e.data("chips").forEach(function(e){t+=n.renderChip(e)}),t+='<input class="input" placeholder="">',e.html(t),n.setPlaceholder(e)},this.renderChip=function(e){if(e.tag){var t='<div class="chip">'+e.tag;return e.image&&(t+=' <img src="'+e.image+'"> '),t+='<i class="material-icons close">close</i>',t+="</div>"}},this.setPlaceholder=function(e){var t=e.data("options");e.data("chips").length&&t.placeholder?e.find("input").prop("placeholder",t.placeholder):!e.data("chips").length&&t.secondaryPlaceholder&&e.find("input").prop("placeholder",t.secondaryPlaceholder)},this.isValid=function(e,t){for(var i=e.data("chips"),a=!1,n=0;n<i.length;n++)if(i[n].tag===t.tag)return void(a=!0);return""!==t.tag&&!a},this.addChip=function(t,i,a){if(n.isValid(a,i)){var s=(a.data("options"),n.renderChip(i));a.data("chips").push(i),e(s).insertBefore(a.find("input")),a.trigger("chip.add",i),n.setPlaceholder(a)}},this.deleteChip=function(e,t,i){var a=i.data("chips")[t];i.find(".chip").eq(t).remove(),i.data("chips").splice(t,1),i.trigger("chip.delete",a),n.setPlaceholder(i)},this.selectChip=function(e,t,i){var a=i.find(".chip").eq(t);a&&!1===a.hasClass("selected")&&(a.addClass("selected"),i.trigger("chip.select",i.data("chips")[t]))},this.getChipsElement=function(e,t){return t.eq(e)},this.init(),void(t||(this.handleEvents(),t=!0)))}}(jQuery);